
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.exaloop.io/libraries/numpy/">
      
      
        <link rel="prev" href="../stdlib/">
      
      
        <link rel="next" href="../api/">
      
      
        
      
      
      <link rel="icon" href="../../img/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16+insiders-4.53.16">
    
    
  
    <title>NumPy | Codon</title>
  

    
      <link rel="stylesheet" href="../../assets/stylesheets/main.1caf78d2.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,700,700i%7CSource+Code+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Open Sans";--md-code-font:"Source Code Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
              </button>
            
            
  <a href="https://discord.gg/HeWRhagCmP">
    <strong>
      ðŸŽ‰ Join our community on Discord
      <span class="discord-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
      </span>
    </strong> â€” Ask questions, share ideas, and get support!
  </a>

          </div>
          
            <script>var el=document.querySelector("[data-md-component=announce]");if(el){var content=el.querySelector(".md-typeset");__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0)}</script>
          
        </aside>
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="" class="md-header__button md-logo" aria-label="" data-md-component="logo">
      
  <img src="../../img/codon-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              NumPy
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/exaloop/codon" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    exaloop/codon
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../start/install/" class="md-tabs__link">
          
  
  
  Get Started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../language/overview/" class="md-tabs__link">
          
  
  
  Language

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../stdlib/" class="md-tabs__link">
          
  
  
  Libraries

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../integrations/python/python-from-codon/" class="md-tabs__link">
          
  
  
  Integrations

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../parallel/multithreading/" class="md-tabs__link">
          
  
  
  Parallel Programming

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../labs/" class="md-tabs__link">
        
  
  
    
  
  Labs

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../developers/compilation/" class="md-tabs__link">
          
  
  
  Developers

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://exaloop.io/blog" class="md-tabs__link">
        
  
  
    
  
  Blog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="" class="md-nav__button md-logo" aria-label="" data-md-component="logo">
      
  <img src="../../img/codon-white.svg" alt="logo">

    </a>
    
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/exaloop/codon" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    exaloop/codon
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Get Started
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Get Started
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/usage/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAQ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../start/changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Changelog
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Language
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Language
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../language/overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../language/classes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Classes
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../language/generics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../language/meta/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Metaprogramming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../language/lowlevel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Low-Level Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../language/llvm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Inline LLVM IR
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Libraries
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Libraries
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../stdlib/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Standard Library
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    NumPy
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    NumPy
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Getting started
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codon-array-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Codon array type
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-interoperability" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Python interoperability
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python interoperability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytorch-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          PyTorch integration
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PyTorch integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-codon-jit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Using Codon JIT
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-codon-python-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Using Codon Python extensions
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Parallel processing
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gpu-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          GPU processing
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-algebra" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Linear algebra
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numpy-specific-compiler-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          NumPy-specific compiler optimizations
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          I/O
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datetimes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Datetimes
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#passing-array-data-to-cc" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Passing array data to C/C++
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Passing array data to C/C++">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array-abi" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Array ABI
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-tips" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Performance tips
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance tips">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array-layouts" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Array layouts
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-huge-pages" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Linux huge pages
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disabling-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Disabling exceptions
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fast-math" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Fast-math
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#not-yet-supported" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Not-yet-supported
        </span>
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Integrations
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Integrations
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Python
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Python
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/python/python-from-codon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Call Python from Codon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/python/codon-from-python/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Call Codon from Python
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/python/extensions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create Python Extensions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    C/C++
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    C/C++
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/cpp/cpp-from-codon/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Call C/C++ from Codon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/cpp/codon-from-cpp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Call Codon from C/C++
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/cpp/jit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Embed Codon JIT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/jupyter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Jupyter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Parallel Programming
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Parallel Programming
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel/multithreading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Multithreading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parallel/gpu/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GPU Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../labs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Labs
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Developers
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Developers
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/compilation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compilation Flow
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/ir/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Intermediate Representation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/extend/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extend Codon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/build/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Build from Source
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/contribute/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contribute
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../developers/roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Roadmap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://exaloop.io/blog" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Getting started
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#codon-array-type" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Codon array type
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-interoperability" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Python interoperability
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python interoperability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pytorch-integration" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          PyTorch integration
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="PyTorch integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-codon-jit" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Using Codon JIT
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-codon-python-extensions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Using Codon Python extensions
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Parallel processing
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gpu-processing" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          GPU processing
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linear-algebra" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Linear algebra
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numpy-specific-compiler-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          NumPy-specific compiler optimizations
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#io" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          I/O
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#datetimes" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Datetimes
        </span>
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#passing-array-data-to-cc" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Passing array data to C/C++
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Passing array data to C/C++">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array-abi" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Array ABI
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-tips" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Performance tips
        </span>
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance tips">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#array-layouts" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Array layouts
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#linux-huge-pages" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Linux huge pages
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#disabling-exceptions" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Disabling exceptions
        </span>
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fast-math" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Fast-math
        </span>
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#not-yet-supported" class="md-nav__link">
    <span class="md-ellipsis">
      
        <span class="md-typeset">
          Not-yet-supported
        </span>
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


  <h1>NumPy</h1>

<p>Codon ships with a feature-complete, fully-compiled native NumPy implementation.
It uses the same API as NumPy, but re-implements everything in Codon itself,
allowing for a range of optimizations and performance improvements. Codon-NumPy
works with Codon's Python interoperability (you can transfer arrays to and from
regular Python seamlessly), parallel backend (you can do array operations in
parallel), and GPU backend (you can transfer arrays to and from the GPU seamlessly,
and operate on them on the GPU).</p>
<h2 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h2>
<p>Importing <code>numpy</code> in Codon will use Codon-NumPy (as opposed to
<code>from python import numpy</code>, which would use standard NumPy):</p>
<div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span></code></pre></div>
<p>We can then create and manipulate arrays just like in standard NumPy:</p>
<div class="highlight"><pre><span></span><code><span id="__span-1-1"><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</span><span id="__span-1-2"><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-1-3"><span class="c1">#   0   1   2   3   4</span>
</span><span id="__span-1-4"><span class="c1">#   5   6   7   8   9</span>
</span><span id="__span-1-5"><span class="c1">#  10  11  12  13  14</span>
</span><span id="__span-1-6">
</span><span id="__span-1-7"><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">::</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span>
</span><span id="__span-1-8"><span class="c1">#   0   1   2   3   4</span>
</span><span id="__span-1-9"><span class="c1"># -99   6 -99   8 -99</span>
</span><span id="__span-1-10"><span class="c1"># -99  11 -99  13 -99</span>
</span><span id="__span-1-11">
</span><span id="__span-1-12"><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-1-13"><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-1-14"><span class="c1">#   4   8  13</span>
</span></code></pre></div>
<p>In Codon-NumPy, any Codon type can be used as the array type. The <code>numpy</code>
module has the same aliases that regular NumPy has, like <code>np.int64</code>,
<code>np.float32</code> etc., but these simply refer to the regular Codon types.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using a string (e.g. <code>"i4"</code> or <code>"f8"</code>) for the dtype is not yet supported.</p>
</div>
<h2 id="codon-array-type">Codon array type<a class="headerlink" href="#codon-array-type" title="Permanent link">&para;</a></h2>
<p>The Codon array type is parameterized by the array data type ("<code>dtype</code>")
and the array dimension ("<code>ndim</code>"). That means that, in Codon-NumPy, the
array dimension is a property of the type, so a 1-d array is a different
type than a 2-d array and so on:</p>
<div class="highlight"><pre><span></span><code><span id="__span-2-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-2-2">
</span><span id="__span-2-3"><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.3</span><span class="p">,</span> <span class="mf">4.4</span><span class="p">]])</span>
</span><span id="__span-2-4"><span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>  <span class="c1"># ndarray[float,2]</span>
</span><span id="__span-2-5">
</span><span id="__span-2-6"><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</span><span id="__span-2-7"><span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>  <span class="c1"># ndarray[int,1]</span>
</span></code></pre></div>
<p>The array dimension must also be known at compile-time. This allows the
compiler to perform a wider range of optimizations on array operations.
Usually, this has no impact on the code as the NumPy functions can
determine input and output dimensions automatically. However, the dimension
(and dtype) must be given when, for instance, reading arrays from disk:</p>
<div class="highlight"><pre><span></span><code><span id="__span-3-1"><span class="c1"># &#39;dtype&#39; argument specifies array type</span>
</span><span id="__span-3-2"><span class="c1"># &#39;ndim&#39; argument specifies array dimension</span>
</span><span id="__span-3-3"><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;arr.npy&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></code></pre></div>
<p>A very limited number of NumPy functions return an array whose dimension
cannot be deduced from its inputs. One such example is <code>squeeze()</code>, which
removes axes of length 1; since the number of axes of length 1 is not
determinable at compile-time, this function requires an extra argument that
indicates which axes to remove.</p>
<h2 id="python-interoperability">Python interoperability<a class="headerlink" href="#python-interoperability" title="Permanent link">&para;</a></h2>
<p>Codon's <code>ndarray</code> type supports Codon's standard Python interoperability API
(i.e. <code>__to_py__</code> and <code>__from_py__</code> methods), so arrays can be transferred to
and from Python seamlessly.</p>
<h3 id="pytorch-integration">PyTorch integration<a class="headerlink" href="#pytorch-integration" title="Permanent link">&para;</a></h3>
<p>Because PyTorch tensors and NumPy arrays are interchangeable without copying
data, it is easy to use Codon to efficiently manipulate or operate on PyTorch
tensors. This can be achieved either via Codon's just-in-time (JIT) compilation
mode or via its Python extension mode.</p>
<h4 id="using-codon-jit">Using Codon JIT<a class="headerlink" href="#using-codon-jit" title="Permanent link">&para;</a></h4>
<p>Here is an example showing initializing a <span class="arithmatex">\(128 \times 128 \times 128\)</span> tensor
<span class="arithmatex">\(A\)</span> such that <span class="arithmatex">\(A_{i,j,k} = i + j + k\)</span>:</p>
<div class="highlight"><pre><span></span><code><span id="__span-4-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-4-2"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-4-3"><span class="kn">import</span><span class="w"> </span><span class="nn">codon</span>
</span><span id="__span-4-4"><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</span><span id="__span-4-5">
</span><span id="__span-4-6"><span class="nd">@codon</span><span class="o">.</span><span class="n">jit</span>
</span><span id="__span-4-7"><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="n">arr</span><span class="p">):</span>
</span><span id="__span-4-8">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
</span><span id="__span-4-9">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
</span><span id="__span-4-10">            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
</span><span id="__span-4-11">                <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span>
</span><span id="__span-4-12">
</span><span id="__span-4-13"><span class="c1"># first call JIT-compiles; subsequent calls use cached JIT&#39;d code</span>
</span><span id="__span-4-14"><span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</span><span id="__span-4-15"><span class="n">initialize</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</span><span id="__span-4-16">
</span><span id="__span-4-17"><span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</span><span id="__span-4-18"><span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-4-19"><span class="n">initialize</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</span><span id="__span-4-20"><span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-4-21">
</span><span id="__span-4-22"><span class="nb">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
</span><span id="__span-4-23"><span class="nb">print</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">,</span> <span class="s1">&#39;seconds&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>Timings on an M1 MacBook Pro:</p>
<ul>
<li>Without <code>@codon.jit</code>: 0.1645 seconds</li>
<li>With <code>@codon.jit</code>: 0.001485 seconds (<em>110x speedup</em>)</li>
</ul>
<p>For more information, see the <a href="../../integrations/python/codon-from-python/">Codon JIT docs</a>.</p>
<h4 id="using-codon-python-extensions">Using Codon Python extensions<a class="headerlink" href="#using-codon-python-extensions" title="Permanent link">&para;</a></h4>
<p>Codon can compile directly to a Python extension module, similar to writing a C
extension for CPython or using Cython.</p>
<p>Taking the same example, we can create a file <code>init.py</code>:</p>
<div class="highlight"><pre><span></span><code><span id="__span-5-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-5-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy.pybridge</span>
</span><span id="__span-5-3">
</span><span id="__span-5-4"><span class="k">def</span><span class="w"> </span><span class="nf">initialize</span><span class="p">(</span><span class="n">arr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="mi">3</span><span class="p">]):</span>
</span><span id="__span-5-5">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
</span><span id="__span-5-6">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
</span><span id="__span-5-7">            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">128</span><span class="p">):</span>
</span><span id="__span-5-8">                <span class="n">arr</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">j</span> <span class="o">+</span> <span class="n">k</span>
</span></code></pre></div>
<p>Note that extension module functions need to specify argument types. In this case,
the argument is a 3-dimensional array of type <code>float32</code>, which is expressed as
<code>np.ndarray[np.float32, 3]</code> in Codon.</p>
<p>Now we can use a setup script <code>setup.py</code> to create the extension module as described
in the <a href="../../integrations/python/extensions/">Codon Python extension docs</a>:</p>
<div class="highlight"><pre><span></span><code><span id="__span-6-1">python3<span class="w"> </span>setup.py<span class="w"> </span>build_ext<span class="w"> </span>--inplace<span class="w">  </span><span class="c1"># setup.py from docs linked above</span>
</span></code></pre></div>
<p>Finally, we can call the function from Python:</p>
<div class="highlight"><pre><span></span><code><span id="__span-7-1"><span class="kn">from</span><span class="w"> </span><span class="nn">codon_initialize</span><span class="w"> </span><span class="kn">import</span> <span class="n">initialize</span>
</span><span id="__span-7-2"><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</span><span id="__span-7-3">
</span><span id="__span-7-4"><span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</span><span id="__span-7-5"><span class="n">initialize</span><span class="p">(</span><span class="n">tensor</span><span class="o">.</span><span class="n">numpy</span><span class="p">())</span>
</span><span id="__span-7-6"><span class="nb">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
</span></code></pre></div>
<p>Note that there is no compilation happening at runtime with this approach. Instead,
everything is compiled ahead of time when creating the extension. The timing is the same
as the first approach.</p>
<p>You can also use any Codon compilation flags with this approach by adding them to the
<code>spawn</code> call in the setup script. For example, you can use the <code>-disable-exceptions</code>
flag to disable runtime exceptions, which can yield performance improvements and generate
more streamlined code.</p>
<h2 id="parallel-processing">Parallel processing<a class="headerlink" href="#parallel-processing" title="Permanent link">&para;</a></h2>
<p>Unlike Python, Codon has no global interpreter lock ("GIL") and supports full
multithreading, meaning NumPy code can be parallelized. For example:</p>
<div class="highlight"><pre><span></span><code><span id="__span-8-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-8-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy.random</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rnd</span>
</span><span id="__span-8-3"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-8-4">
</span><span id="__span-8-5"><span class="n">N</span> <span class="o">=</span> <span class="mi">100000000</span>
</span><span id="__span-8-6"><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-8-7">
</span><span id="__span-8-8"><span class="n">rng</span> <span class="o">=</span> <span class="n">rnd</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-8-9"><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
</span><span id="__span-8-10"><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-8-11">
</span><span id="__span-8-12"><span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-8-13">
</span><span id="__span-8-14"><span class="nd">@par</span><span class="p">(</span><span class="n">num_threads</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-8-15"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-8-16">    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="__span-8-17">
</span><span id="__span-8-18"><span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-8-19">
</span><span id="__span-8-20"><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</span><span id="__span-8-21"><span class="nb">print</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">,</span> <span class="s1">&#39;seconds&#39;</span><span class="p">)</span>
</span><span id="__span-8-22"><span class="c1"># no par - 1.4s</span>
</span><span id="__span-8-23"><span class="c1"># w/ par - 0.4s</span>
</span></code></pre></div>
<h2 id="gpu-processing">GPU processing<a class="headerlink" href="#gpu-processing" title="Permanent link">&para;</a></h2>
<p>Codon-NumPy supports seamless GPU processing: arrays can be passed to and
from the GPU, and array operations can be performed on the GPU using Codon's
GPU backend. Here's an example that computes the Mandelbrot set:</p>
<div class="highlight"><pre><span></span><code><span id="__span-9-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-9-2"><span class="kn">import</span><span class="w"> </span><span class="nn">gpu</span>
</span><span id="__span-9-3">
</span><span id="__span-9-4"><span class="n">MAX</span>    <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># maximum Mandelbrot iterations</span>
</span><span id="__span-9-5"><span class="n">N</span>      <span class="o">=</span> <span class="mi">4096</span>  <span class="c1"># width and height of image</span>
</span><span id="__span-9-6"><span class="n">pixels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="__span-9-7">
</span><span id="__span-9-8"><span class="k">def</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span><span id="__span-9-9">    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
</span><span id="__span-9-10">
</span><span id="__span-9-11"><span class="nd">@gpu</span><span class="o">.</span><span class="n">kernel</span>
</span><span id="__span-9-12"><span class="k">def</span><span class="w"> </span><span class="nf">mandelbrot</span><span class="p">(</span><span class="n">pixels</span><span class="p">):</span>
</span><span id="__span-9-13">    <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">gpu</span><span class="o">.</span><span class="n">block</span><span class="o">.</span><span class="n">x</span> <span class="o">*</span> <span class="n">gpu</span><span class="o">.</span><span class="n">block</span><span class="o">.</span><span class="n">dim</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">gpu</span><span class="o">.</span><span class="n">thread</span><span class="o">.</span><span class="n">x</span>
</span><span id="__span-9-14">    <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">gpu</span><span class="o">.</span><span class="n">block</span><span class="o">.</span><span class="n">y</span> <span class="o">*</span> <span class="n">gpu</span><span class="o">.</span><span class="n">block</span><span class="o">.</span><span class="n">dim</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">gpu</span><span class="o">.</span><span class="n">thread</span><span class="o">.</span><span class="n">y</span>
</span><span id="__span-9-15">    <span class="n">c</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.00</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">),</span> <span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.12</span><span class="p">,</span> <span class="mf">1.12</span><span class="p">))</span>
</span><span id="__span-9-16">    <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="n">j</span>
</span><span id="__span-9-17">    <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-9-18">
</span><span id="__span-9-19">    <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="n">MAX</span><span class="p">:</span>
</span><span id="__span-9-20">        <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span>
</span><span id="__span-9-21">        <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-9-22">
</span><span id="__span-9-23">    <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">*</span> <span class="n">iteration</span><span class="o">/</span><span class="n">MAX</span>
</span><span id="__span-9-24">
</span><span id="__span-9-25"><span class="n">mandelbrot</span><span class="p">(</span><span class="n">pixels</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="n">N</span><span class="o">//</span><span class="mi">32</span><span class="p">,</span> <span class="n">N</span><span class="o">//</span><span class="mi">32</span><span class="p">),</span> <span class="n">block</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span>
</span></code></pre></div>
<p>Here is the same code using GPU-parallelized <code>for</code>-loops:</p>
<div class="highlight"><pre><span></span><code><span id="__span-10-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-10-2"><span class="kn">import</span><span class="w"> </span><span class="nn">gpu</span>
</span><span id="__span-10-3">
</span><span id="__span-10-4"><span class="n">MAX</span>    <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># maximum Mandelbrot iterations</span>
</span><span id="__span-10-5"><span class="n">N</span>      <span class="o">=</span> <span class="mi">4096</span>  <span class="c1"># width and height of image</span>
</span><span id="__span-10-6"><span class="n">pixels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">),</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="__span-10-7">
</span><span id="__span-10-8"><span class="k">def</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
</span><span id="__span-10-9">    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">N</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>
</span><span id="__span-10-10">
</span><span id="__span-10-11"><span class="nd">@par</span><span class="p">(</span><span class="n">gpu</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">collapse</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># &lt;--</span>
</span><span id="__span-10-12"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
</span><span id="__span-10-13">    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
</span><span id="__span-10-14">        <span class="n">c</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">scale</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.00</span><span class="p">,</span> <span class="mf">0.47</span><span class="p">),</span> <span class="n">scale</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.12</span><span class="p">,</span> <span class="mf">1.12</span><span class="p">))</span>
</span><span id="__span-10-15">        <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span><span class="n">j</span>
</span><span id="__span-10-16">        <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-10-17">
</span><span id="__span-10-18">        <span class="k">while</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="n">MAX</span><span class="p">:</span>
</span><span id="__span-10-19">            <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">c</span>
</span><span id="__span-10-20">            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-10-21">
</span><span id="__span-10-22">        <span class="n">pixels</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">255</span> <span class="o">*</span> <span class="n">iteration</span><span class="o">/</span><span class="n">MAX</span>
</span></code></pre></div>
<h2 id="linear-algebra">Linear algebra<a class="headerlink" href="#linear-algebra" title="Permanent link">&para;</a></h2>
<p>Codon-NumPy fully supports the NumPy linear algebra module which provides
a comprehensive set of functions for linear algebra operations. Importing
the linear algebra module, just like in standard NumPy:</p>
<div class="highlight"><pre><span></span><code><span id="__span-11-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy.linalg</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">LA</span>
</span></code></pre></div>
<p>For example, the <code>eig()</code> function computes the eigenvalues and eigenvectors
of a square matrix:</p>
<div class="highlight"><pre><span></span><code><span id="__span-12-1"><span class="n">eigenvalues</span><span class="p">,</span> <span class="n">eigenvectors</span> <span class="o">=</span> <span class="n">LA</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
</span><span id="__span-12-2"><span class="nb">print</span><span class="p">(</span><span class="n">eigenvalues</span><span class="p">)</span>
</span><span id="__span-12-3"><span class="c1"># 1.+0.j 2.+0.j 3.+0.j</span>
</span><span id="__span-12-4">
</span><span id="__span-12-5"><span class="nb">print</span><span class="p">(</span><span class="n">eigenvectors</span><span class="p">)</span>
</span><span id="__span-12-6"><span class="c1"># [[1.+0.j 0.+0.j 0.+0.j]</span>
</span><span id="__span-12-7"><span class="c1">#  [0.+0.j 1.+0.j 0.+0.j]</span>
</span><span id="__span-12-8"><span class="c1">#  [0.+0.j 0.+0.j 1.+0.j]]</span>
</span></code></pre></div>
<p>Just like standard NumPy, Codon will use an optimized BLAS library under the
hood to implement many linear algebra operations. This defaults to OpenBLAS
on Linux and Apple's Accelerate framework on macOS.</p>
<p>Because Codon supports full multithreading, it's possible to use outer-loop
parallelism to perform linear algebra operations in parallel. Here's an example
that multiplies several matrices in parallel:</p>
<div class="highlight"><pre><span></span><code><span id="__span-13-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-13-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy.random</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">rnd</span>
</span><span id="__span-13-3"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-13-4">
</span><span id="__span-13-5"><span class="n">N</span> <span class="o">=</span> <span class="mi">5000</span>
</span><span id="__span-13-6"><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-13-7"><span class="n">rng</span> <span class="o">=</span> <span class="n">rnd</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-13-8"><span class="n">a</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
</span><span id="__span-13-9"><span class="n">b</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
</span><span id="__span-13-10"><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">N</span><span class="p">))</span>
</span><span id="__span-13-11"><span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-13-12">
</span><span id="__span-13-13"><span class="nd">@par</span><span class="p">(</span><span class="n">num_threads</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-13-14"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span><span id="__span-13-15">    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">@</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
</span><span id="__span-13-16">
</span><span id="__span-13-17"><span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-13-18"><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</span><span id="__span-13-19"><span class="nb">print</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">,</span> <span class="s1">&#39;seconds&#39;</span><span class="p">)</span>  <span class="c1"># Python - 53s</span>
</span><span id="__span-13-20">                           <span class="c1"># Codon  -  6s</span>
</span></code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>When using Codon's outer-loop parallelism, make sure to set the environment
variable <code>OPENBLAS_NUM_THREADS</code> to 1 (i.e. <code>export OPENBLAS_NUM_THREADS=1</code>)
to avoid conflicts with OpenBLAS multithreading.</p>
</div>
<h2 id="numpy-specific-compiler-optimizations">NumPy-specific compiler optimizations<a class="headerlink" href="#numpy-specific-compiler-optimizations" title="Permanent link">&para;</a></h2>
<p>Codon includes compiler passes that optimize NumPy code through methods like
operator fusion, which combine distinct operations so that they can be executed
during a single pass through the argument arrays, saving both execution time and
memory (since intermediate arrays no longer need to be allocated).</p>
<p>To showcase this, here's a simple NumPy program that approximates <span class="arithmatex">\(\pi\)</span>.
The code below generates two random vectors <span class="arithmatex">\(x\)</span> and <span class="arithmatex">\(y\)</span> with entries in the
range <span class="arithmatex">\([0, 1)\)</span> and computes the fraction of pairs of points that lie in the
circle of radius <span class="arithmatex">\(0.5\)</span> centered at <span class="arithmatex">\((0.5, 0.5)\)</span>, which is approximately
<span class="arithmatex">\(\pi \over 4\)</span>.</p>
<div class="highlight"><pre><span></span><code><span id="__span-14-1"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="__span-14-2"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-14-3">
</span><span id="__span-14-4"><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-14-5"><span class="n">x</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">500_000_000</span><span class="p">)</span>
</span><span id="__span-14-6"><span class="n">y</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">500_000_000</span><span class="p">)</span>
</span><span id="__span-14-7">
</span><span id="__span-14-8"><span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-14-9"><span class="c1"># pi ~= 4 x (fraction of points in circle)</span>
</span><span id="__span-14-10"><span class="n">pi</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">4</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</span><span id="__span-14-11"><span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="__span-14-12">
</span><span id="__span-14-13"><span class="nb">print</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
</span><span id="__span-14-14"><span class="nb">print</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">,</span> <span class="s1">&#39;seconds&#39;</span><span class="p">)</span>
</span></code></pre></div>
<p>The expression <code>(x-1)**2 + (y-1)**2 &lt; 1</code> gets fused by Codon so that it is
executed in just a single pass over the <code>x</code> and <code>y</code> arrays, rather than in
multiple passes for each sub-expression <code>x-1</code>, <code>y-1</code> etc. as is the case with
standard NumPy.</p>
<p>Here are the resulting timings on an M1 MacBook Pro:</p>
<ul>
<li>Python / standard NumPy: 2.4 seconds</li>
<li>Codon: 0.42 seconds (<em>6x speedup</em>)</li>
</ul>
<p>You can display information about fused expressions by using the <code>-npfuse-verbose</code>
flag of <code>codon</code>, as in <code>codon run -release -npfuse-verbose pi.py</code>. Here's the
output for the program above:</p>
<div class="highlight"><pre><span></span><code><span id="__span-15-1">Optimizing expression at pi.py:10:7
</span><span id="__span-15-2">lt &lt;array[bool, 1]&gt; [cost=6]
</span><span id="__span-15-3">  add &lt;array[f64, 1]&gt; [cost=5]
</span><span id="__span-15-4">    pow &lt;array[f64, 1]&gt; [cost=2]
</span><span id="__span-15-5">      sub &lt;array[f64, 1]&gt; [cost=1]
</span><span id="__span-15-6">        a0 &lt;array[f64, 1]&gt;
</span><span id="__span-15-7">        a1 &lt;i64&gt;
</span><span id="__span-15-8">      a2 &lt;i64&gt;
</span><span id="__span-15-9">    pow &lt;array[f64, 1]&gt; [cost=2]
</span><span id="__span-15-10">      sub &lt;array[f64, 1]&gt; [cost=1]
</span><span id="__span-15-11">        a3 &lt;array[f64, 1]&gt;
</span><span id="__span-15-12">        a4 &lt;i64&gt;
</span><span id="__span-15-13">      a5 &lt;i64&gt;
</span><span id="__span-15-14">  a6 &lt;i64&gt;
</span><span id="__span-15-15">
</span><span id="__span-15-16">-&gt; static fuse:
</span><span id="__span-15-17">lt &lt;array[bool, 1]&gt; [cost=6]
</span><span id="__span-15-18">  add &lt;array[f64, 1]&gt; [cost=5]
</span><span id="__span-15-19">    pow &lt;array[f64, 1]&gt; [cost=2]
</span><span id="__span-15-20">      sub &lt;array[f64, 1]&gt; [cost=1]
</span><span id="__span-15-21">        a0 &lt;array[f64, 1]&gt;
</span><span id="__span-15-22">        a1 &lt;i64&gt;
</span><span id="__span-15-23">      a2 &lt;i64&gt;
</span><span id="__span-15-24">    pow &lt;array[f64, 1]&gt; [cost=2]
</span><span id="__span-15-25">      sub &lt;array[f64, 1]&gt; [cost=1]
</span><span id="__span-15-26">        a3 &lt;array[f64, 1]&gt;
</span><span id="__span-15-27">        a4 &lt;i64&gt;
</span><span id="__span-15-28">      a5 &lt;i64&gt;
</span><span id="__span-15-29">  a6 &lt;i64&gt;
</span></code></pre></div>
<p>As shown, the optimization pass employs a cost model to decide how to best handle
a given expression, be it by fusing or evaluating sequentially. You can adjust the
fusion cost thresholds via the following flags:</p>
<ul>
<li><code>-npfuse-always &lt;cost1&gt;</code>: Expression cost below which to always fuse a given
  expression (default: <code>10</code>).</li>
<li><code>-npfuse-never &lt;cost2&gt;</code>: Expression cost above which (&gt;) to never fuse a given
  expression (default: <code>50</code>).</li>
</ul>
<p>Given an expression cost <code>C</code>, the logic implemented in the pass is to:</p>
<ul>
<li>Always fuse expressions where <code>C &lt;= cost1</code>.</li>
<li>Fuse expressions where <code>cost1 &lt; C &lt;= cost2</code> if there is no broadcasting involved.</li>
<li>Never fuse expressions where <code>C &gt; cost2</code> and instead evaluate them sequentially.</li>
</ul>
<p>This logic is applied recursively to a given expression to determine the optimal
evaluation strategy.</p>
<p>You can disable these optimizations altogether by disabling the corresponding
compiler pass via the flag <code>-disable-opt core-numpy-fusion</code>.</p>
<h2 id="io">I/O<a class="headerlink" href="#io" title="Permanent link">&para;</a></h2>
<p>Codon-NumPy supports most of NumPy's I/O API. One important difference, however,
is that I/O functions must specify the dtype and dimension of arrays being read,
since Codon-NumPy array types are parameterized by dtype and dimension:</p>
<div class="highlight"><pre><span></span><code><span id="__span-16-1"><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-16-2">
</span><span id="__span-16-3"><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</span><span id="__span-16-4"><span class="n">np</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;arr.npy&#39;</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</span><span id="__span-16-5">
</span><span id="__span-16-6"><span class="c1"># Notice the &#39;dtype&#39; and &#39;ndim&#39; arguments:</span>
</span><span id="__span-16-7"><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;arr.npy&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int16</span><span class="p">,</span> <span class="n">ndim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</span></code></pre></div>
<p>Writing arrays has no such requirement.</p>
<h2 id="datetimes">Datetimes<a class="headerlink" href="#datetimes" title="Permanent link">&para;</a></h2>
<p>Codon-NumPy fully supports NumPy's datetime types: <code>datetime64</code> and <code>timedelta64</code>.
One difference from standard NumPy is how these types are specified. Here's an example:</p>
<div class="highlight"><pre><span></span><code><span id="__span-17-1"><span class="c1"># datetime64 type with units of &quot;1 day&quot;</span>
</span><span id="__span-17-2"><span class="c1"># same as &quot;dtype=&#39;datetime64[D]&#39;&quot; in standard NumPy</span>
</span><span id="__span-17-3"><span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;2020-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2021-09-15&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-07-01&#39;</span><span class="p">],</span>
</span><span id="__span-17-4">              <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="__span-17-5">
</span><span id="__span-17-6"><span class="c1"># timedelta64 type with units of &quot;15 minutes&quot;</span>
</span><span id="__span-17-7"><span class="c1"># same as &quot;dtype=&#39;timedelta64[15m]&#39;&quot; in standard NumPy</span>
</span><span id="__span-17-8"><span class="n">td</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>
</span></code></pre></div>
<h2 id="passing-array-data-to-cc">Passing array data to C/C++<a class="headerlink" href="#passing-array-data-to-cc" title="Permanent link">&para;</a></h2>
<p>You can pass an <code>ndarray</code>'s underlying data pointer to a C/C++ function by using
the <code>data</code> attribute of the array. For example:</p>
<div class="highlight"><pre><span></span><code><span id="__span-18-1"><span class="kn">from</span><span class="w"> </span><span class="nn">C</span><span class="w"> </span><span class="kn">import</span> <span class="n">foo</span><span class="p">(</span><span class="n">p</span><span class="p">:</span> <span class="n">Ptr</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span>
</span><span id="__span-18-2">
</span><span id="__span-18-3"><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
</span><span id="__span-18-4"><span class="n">foo</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">arr</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</span></code></pre></div>
<p>Of course, it's the caller's responsibility to make sure the array is contiguous
as needed and/or pass additional shape or stride information. See the
<a href="../../integrations/cpp/cpp-from-codon/">C interoperability</a> docs for more information.</p>
<h3 id="array-abi">Array ABI<a class="headerlink" href="#array-abi" title="Permanent link">&para;</a></h3>
<p>The <code>ndarray[dtype, ndim]</code> data structure has three fields, in the following order:</p>
<ul>
<li><code>shape</code>: length-<code>ndim</code> tuple of non-negative 64-bit integers representing the array
  shape</li>
<li><code>strides</code>: length-<code>ndim</code> tuple of 64-bit integers representing the stride in bytes
  along each axis of the array</li>
<li><code>data</code>: pointer of type <code>dtype</code> to the array's data</li>
</ul>
<p>For example, <code>ndarray[np.float32, 3]</code> would correspond to the following C structure:</p>
<div class="highlight"><pre><span></span><code><span id="__span-19-1"><span class="k">struct</span><span class="w"> </span><span class="nc">ndarray_float32_3</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-2"><span class="w">  </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">shape</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span><span id="__span-19-3"><span class="w">  </span><span class="kt">int64_t</span><span class="w"> </span><span class="n">strides</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
</span><span id="__span-19-4"><span class="w">  </span><span class="kt">float</span><span class="w"> </span><span class="o">*</span><span class="n">data</span><span class="p">;</span>
</span><span id="__span-19-5"><span class="p">};</span>
</span></code></pre></div>
<p>This can be used to pass an entire <code>ndarray</code> object to a C function without breaking
it up into its constituent components.</p>
<h2 id="performance-tips">Performance tips<a class="headerlink" href="#performance-tips" title="Permanent link">&para;</a></h2>
<h3 id="array-layouts">Array layouts<a class="headerlink" href="#array-layouts" title="Permanent link">&para;</a></h3>
<p>As with standard NumPy, Codon-NumPy performs best when array data is contiguous in
memory, ideally in row-major order (also called "C order"). Most NumPy functions will
return C-order arrays, but operations like slicing and transposing arrays can alter
contiguity. You can use <code>numpy.ascontiguousarray()</code> to create a contiguous array from
an arbitrary array.</p>
<h3 id="linux-huge-pages">Linux huge pages<a class="headerlink" href="#linux-huge-pages" title="Permanent link">&para;</a></h3>
<p>When working with large arrays on Linux, enabling
<a href="https://www.kernel.org/doc/html/latest/admin-guide/mm/transhuge.html">transparent hugepages</a>
can result in significant performance improvements.</p>
<p>You can check if transparent hugepages are enabled via</p>
<div class="highlight"><pre><span></span><code><span id="__span-20-1">cat<span class="w"> </span>/sys/kernel/mm/transparent_hugepage/enabled
</span></code></pre></div>
<p>and you can enable them via</p>
<div class="highlight"><pre><span></span><code><span id="__span-21-1"><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;always&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/sys/kernel/mm/transparent_hugepage/enabled
</span></code></pre></div>
<h3 id="disabling-exceptions">Disabling exceptions<a class="headerlink" href="#disabling-exceptions" title="Permanent link">&para;</a></h3>
<p>By default, Codon performs various validation checks at runtime (e.g. bounds checks when
indexing an array) just like standard NumPy, and raises an exception if they fail. If
you know your program will not raise or catch any exceptions, you can disable these
checks through the <code>-disable-exceptions</code> compiler flag.</p>
<p>Note that when using this flag, raising an exception will terminate the process with a
<code>SIGTRAP</code>.</p>
<h3 id="fast-math">Fast-math<a class="headerlink" href="#fast-math" title="Permanent link">&para;</a></h3>
<p>You can enable "fast-math" optimizations via the <code>-fast-math</code> compiler flag. It is
advisable to <strong>use this flag with caution</strong> as it changes floating point semantics and
makes assumptions regarding <code>inf</code> and <code>nan</code> values. For more information, consult LLVM's
documentation on <a href="https://llvm.org/docs/LangRef.html#fast-math-flags">fast-math flags</a>.</p>
<h2 id="not-yet-supported">Not-yet-supported<a class="headerlink" href="#not-yet-supported" title="Permanent link">&para;</a></h2>
<p>The following features of NumPy are not yet supported, but are planned for the future:
- String operations
- Masked arrays
- Polynomials</p>
<p>A few miscellaneous Python-specific functions like <code>get_include()</code> are also not
supported, as they are not applicable in Codon.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Exaloop, Inc.
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/exaloop" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://discord.gg/HeWRhagCmP" target="_blank" rel="noopener" title="discord.gg" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/exaloop" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M357.2 48h70.6L273.6 224.2 455 464H313L201.7 318.6 74.5 464H3.8l164.9-188.5L-5.2 48h145.6l100.5 132.9zm-24.8 373.8h39.1L119.1 88h-42z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/company/exaloop" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["content.code.copy", "search.suggest", "search.highlight", "navigation.tracking", "navigation.sections", "navigation.expand", "navigation.tabs", "navigation.top", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.ad38c271.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.b66b2b78.min.js"></script>
      
        <script src="../../js/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>